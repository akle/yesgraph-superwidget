!function(){function e(){function e(e,t,n){return window.hasOwnProperty(e)?void n(window[e]):function(o,i){var a=o.createElement(i),r=o.getElementsByTagName(i)[0];a.src=t,r.parentNode.insertBefore(a,r),a.onload=function(){n(window[e])}}(document,"script")}var o=-1!==window.location.protocol.indexOf("http")?window.location.protocol:"http:";e("jQuery","https://code.jquery.com/jquery-2.1.1.min.js",function(a){e("YesGraphAPI","https://cdn.yesgraph.com/"+t+"/yesgraph.min.js",function(t){return t.hasLoadedSuperwidget?void t.error("Superwidget has been loaded multiple times.",!1):(t.hasLoadedSuperwidget=!0,t.getSettings=t.getSettings||function(){return{app:null,testmode:!1,target:".yesgraph-invites",contactImporting:!0,emailSending:!0,inviteLink:!0,shareBtns:!0}},void e("Clipboard","https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.8/clipboard.min.js",function(r){function s(){for(var e,t=document.styleSheets,n=0;n<t.length;n++)if(e=t[n].href||"",e.match(/yesgraph-invites[\S]*.css\b/))return;a("head").prepend(_)}function c(){var e=a.Deferred(),n=setInterval(function(){t.getApp()&&t.hasClientToken()&&a(t.getSettings().target).length>0&&(clearInterval(n),C.val(t.getInviteLink()),t.isTestMode=f,t.events=a.extend(t.events,{SET_RECIPIENTS:"set.yesgraph.recipients",IMPORTED_CONTACTS:"imported.yesgraph.contacts"}),e.resolve())},100);return e.promise()}function d(e){var t,n,o,r=[];if(e.is("textarea")){n=e.val().split(",");for(i in n)o=n[i].replace(/^\s+|\s+$/g,""),o&&(u(o)?r.push({email:o}):j.error('Invalid email "'+o+'".'));return r}checked=e.find('input[type="checkbox"]').filter(function(){return Boolean(a(this).prop("checked"))});var r=[];return checked.map(function(){var e=a(this);t={name:e.data("name")||void 0,email:e.data("email")||void 0},r.push(t)}),r}function l(e){var n=a.Deferred();if(!e||e.length<1){var o="No valid recipients specified.";j.error(o),n.reject({error:o})}else a(document).trigger(t.events.SET_RECIPIENTS,[e]),t.getSettings().emailSending?m(v.settings||{})?t.hitAPI("/send-email-invites","POST",{recipients:e,test:g||void 0,invite_link:t.getInviteLink()}).done(function(e){if(e.emails){if(g)j.success("Testmode: emails not sent.");else{for(var o,i=(e.sent.length,{entries:[]}),a=0;a<e.sent.length;a++)o=e.sent[a],i.entries.push({invitee_name:o[0]||void 0,email:o[1],sent_at:(new Date).toISOString()});t.postInvitesSent(i)}n.resolve()}else n.reject(e),j.error(e),t.error(e)}).fail(function(e){j.error(e.error),t.error(e.error,!1),n.reject(e)}):n.reject():n.resolve(),n.done(function(){o="You've added "+e.length,o+=1===e.length?" friend!":" friends!",j.success(o)});return n.promise()}function p(e,t){t=t.replace(new RegExp("/[[]/"),"[").replace(new RegExp("/[]]/"),"]");var n="[?&#]"+t+"=([^&#]*)",o=new RegExp(n),i=o.exec(e);return null==i?null:i[1]}function u(e){var t=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/gim;return t.test(e)}function f(e){return-1!==[!0,!1].indexOf(e)&&(g=e),g}function m(e){var t,n;return void 0!==e.hasValidEmailSettings?(t=e.hasValidEmailSettings[0],n=e.hasValidEmailSettings[1]):t=e.hasEmailTemplate&&e.hasSendGridApiKey,t||j.error(n),t}var h,g,v,y,w=a("<div>",{"class":"yes-widget-container"}),b=a("<div>",{"class":"yes-header-1"}),x=a("<div>"),k=a("<div>",{"class":"yes-share-btn-section"}),S=a("<div>"),_=a("<link>",{rel:"stylesheet",type:"text/css",charset:"utf-8",href:o+"//cdn.yesgraph.com/"+n+"/yesgraph-invites.min.css"}),I=a("<span>",{id:"powered-by-yesgraph",text:"Powered by ",style:"display: block !important; visibility: visible !important; font-size: 12px !important; font-style: italic !important;"}).append(a("<a>",{href:"https://www.yesgraph.com/demo?utm_source=superwidget&utm_medium=superwidget&utm_campaign=superwidget",text:"YesGraph",target:"_blank",style:"color: red !important; text-decoration: none !important;"})),C=a("<input>",{readonly:!0,id:"yes-invite-link"}).css({width:"100%",border:"1px solid #ccc","text-overflow":"ellipsis",padding:"5px 7px"}).on("click",function(){this.select()}),O=a("<span>",{id:"yes-invite-link-copy-btn","data-clipboard-target":"#yes-invite-link",text:"Copy"}).css({display:"table-cell",border:"1px solid #ccc","border-left":"none",padding:"5px 7px","background-color":"#eee",cursor:"pointer"}),A=a("<div>",{"class":"yes-invite-link-section"}).css({display:"table",width:"100%","font-size":"0.85em",margin:"5px 0"}).append(C,O);y="YesGraph"===window.document.title&&-1!==["localhost","lvh.me"].indexOf(window.location.hostname)?window.location.origin:"https://www.yesgraph.com",s();var j=function(){function e(e,t,n){var o=a("<div>",{"class":"yes-flash yes-flash-"+t,text:e||""});S.append(o.hide()),o.show(300),setTimeout(function(){o.hide(300,function(){delete a(this)})},n||3500)}function t(t,n){t=t||"Success!",e(t,"success",n)}function n(t,n){t="Error: "+(t||"Something went wrong."),e(t,"error",n)}return{success:t,error:n}}(),E=function(){function e(){var e=v.widgetCopy||{};y=e.contactsModalHeader||"Add Friends",E.text(y),S.append(E,C),_.append(O),I.append(A),w.append(S,_,I),a("body").append(b,w),c(),a(window).on("resize",m),C.on("click",f),b.on("click",f),A.on("click",p),M.on("click",function(e){_.find("[type='checkbox']").prop("checked",a(e.target).prop("checked")),n()}),w.hide(),b.hide()}function n(){var e="",t=v.widgetCopy.modalSendBtn||{},n=_.find('input[type="checkbox"]').filter(":not(.yes-select-all-form *)").filter(function(){return Boolean(a(this).prop("checked"))});e=0===n.length?t.noneSelected||"No contacts selected":1===n.length?t.oneSelected||"Send 1 Email":t.manySelected||"Send {{ count }} Emails",e=e.replace(/{{[\s]*count[\s]*}}/i,n.length),A.val(e)}function o(e){var t=a(e.target).find("[type='checkbox']");t.prop("checked",!t.prop("checked")),n()}function r(e,t,n){if(t.emails&&0!==t.emails.length)for(var i,r,s,c=n?t.emails.length:1,d=a.map(T.find(".yes-contact-row-checkbox input"),function(e,t){return a(e).data("email")}),l=0;c>l;l++)-1===d.indexOf(t.emails[l])&&(r=a("<span>",{html:t.emails[l]}),s=a("<input>",{type:"checkbox"}),i=a("<div>",{"class":"yes-contact-row"}),i.append(a("<div>",{"class":"yes-contact-row-checkbox"}).append(s)),i.append(a("<div>",{"class":"yes-contact-row-name"})),i.append(a("<div>",{"class":"yes-contact-row-email"}).append(r)),t.name&&i.find(".yes-contact-row-name").append(a("<span>",{html:t.name})),s.data("email",t.emails[0]),s.data("name",t.name||void 0),s.data(""),i.on("click",o),e.append(i))}function s(e,o){function i(e,t){var n,o,i=e.name||"",a=e.emails||"",r=t.name||"",s=t.emails||"",c=/\b([0-9]*)/,d=/\b[0-9]*(.*)/;if(i&&r){if(n=c.exec(i),n=Number(n?n[0]:void 0),c.lastIndex=0,o=c.exec(r),o=Number(o?o[0]:void 0),c.lastIndex=0,n&&!o)return 1;if(o&&!n)return-1;if(n&&o){if(o>n)return-1;if(n>o)return 1;if(n==o){var l=d.exec(i)[0];d.lastIndex=0;var p=d.exec(r)[0];return d.lastIndex=0,p>=l?-1:1}}return r>=i?-1:1}return i||r?Boolean(t.name)-Boolean(e.name):a&&s?a[0]<=s[0]?-1:1:0}var s=a("<div>",{style:"height: 100%; position: relative; overflow: auto;"}).append(R),d=a("<div>",{style:"height: 100%; display: table-cell; width: 100%;"}).append(s),l=a("<div>",{style:"max-height: 180px; overflow: scroll;"}).append(T),p=a("<p>",{text:"None found!","class":"yes-none-found-warning"}),u=5;if(o=e.length<u||o,0===e.length)return g(),E.text("No contacts found!"),void A.css("visibility","hidden");if(!o){for(var f={entries:[]},m=0;u>m;m++)contact=e[m],contact.name&&f.entries.push({name:contact.name,emails:contact.emails,seen_at:(new Date).toISOString()}),r(T,contact,!1);t.postSuggestedSeen(f)}for(var h=e.sort(i),m=0;m<h.length;m++)contact=h[m],r(R,contact,!0);R.prepend(p.hide()),o?O.append(D,P,U,d):O.append(D,P,L,l,U,d),g(),o||T.find("input[type='checkbox']").prop("checked",!0),a.expr[":"].Contains=function(e,t,n){return jQuery(e).text().toUpperCase().indexOf(n[3].toUpperCase())>=0},D.on("input",function(e){var t,n=e.target.value;R.find(".yes-contact-row").hide(),t=R.find('.yes-contact-row:Contains("'+n+'")'),t.show(),0===t.length?p.show():p.hide()}),n(),c()}function c(){M.css({margin:"0 6px"}),P.css({"font-weight":"200"}),R.css({position:"absolute",top:"0",bottom:"0",left:"0",right:"0"}),a(".yes-contact-list-header").css({display:"table-row","font-size":"16px","font-weight":"bolder",height:"30px","line-height":"30px",margin:"0"})}function p(e){try{e.preventDefault()}catch(n){}A.prop("disabled",!0);var o=d(T),a=d(R),r=o.concat(a),s=[],c=[];for(i in r){var p=r[i];-1===c.indexOf(p.email)&&(c.push(p.email),s.push(p))}l(r).fail(function(e){j.error("Email invite sending failed"),t.error("Email invite sending failed")}).always(function(){A.prop("disabled",!1),f()})}function u(e){try{e.preventDefault()}catch(t){}w.show(),m(),b.show(),k=!0}function f(e){try{e.preventDefault()}catch(t){}w.hide(),b.hide(),k=!1}function m(e){try{e.preventDefault()}catch(t){}var n=20,o=Math.max(a(window).width()-w.outerWidth(),0)/2;window.document.doctype&&"html"===window.document.doctype&&(n=Math.max(a(window).height()-w.outerHeight(),0)/2),w.css({top:n+a(window).scrollTop(),left:o+a(window).scrollLeft()})}function h(){b.show();var e=O.children(),t=a(".yes-contact-row").add(".yes-none-found-warning");e.detach(),t.remove(),A.css("visibility","hidden"),E.text("Loading contacts..."),x.css("display","block"),w.show(),m(),k=!0}function g(){A.css("visibility","visible"),E.text(y),x.css("display","none")}var y,w=a("<div>",{"class":"yes-modal"}),b=a("<div>",{"class":"yes-modal-overlay"}),x=a("<div>",{"class":"yes-loading-icon"}),k=!1,S=a("<div>",{"class":"yes-modal-header"}),_=a("<div>",{"class":"yes-modal-body"}).append(x),I=a("<div>",{"class":"yes-modal-footer"}),C=a("<div>",{html:"&times;","class":"yes-modal-close-btn"}),O=a("<div>",{"class":"yes-contact-container"}),A=a("<input>",{type:"submit",value:"Add","class":"yes-default-btn yes-modal-submit-btn"}),E=a("<p>",{"class":"yes-modal-title"}),D=a("<input>",{type:"text",placeholder:"Search","class":"yes-search-field"}),L=a("<p>",{text:"Suggested","class":"yes-contact-list-header"}),T=a("<div>",{"class":"yes-suggested-contact-list"}),U=a("<p>",{text:"All Contacts","class":"yes-contact-list-header"}),R=a("<div>",{"class":"yes-total-contact-list"}),M=a("<input>",{type:"checkbox"}),P=a("<form>",{"class":"yes-select-all-form"}).append(M,a("<label>",{text:"Select All"}));return{init:e,isOpen:k,openModal:u,closeModal:f,loadContacts:s,loading:h,stopLoading:g}}(),D=function(){function n(){function e(e){var t=a("<div>",{"class":"yes-contact-import-btn-icon"}),n=a("<span>",{text:M+e.name,"class":"yes-contact-import-btn-text"}),o=a("<div>").css("display","table").append(t,n),i=a("<div>").css({display:"inline-block","vertical-align":"middle"}).append(o),r="yes-default-btn yes-contact-import-btn yes-contact-import-btn-"+e.id,s=a("<button>",{"class":r+(D>3?" yes-no-label":""),title:e.name}).append(i);return s}var n=t.getSettings()||{},o=n.target||".yesgraph-invites";a(o).append(w),g=n.testmode||!1;var i=[b,x];n.inviteLink&&i.push(A),n.shareBtns&&i.push(k),i.push(S),w.append(i),v.poweredByYesgraph&&w.append(I);var p=v.widgetCopy||{};if(p.widgetHeadline){var u=a("<p>",{"class":"yes-header-1",text:p.widgetHeadline});b.append(u)}var f=new r("#yes-invite-link-copy-btn");f.on("success",function(e){var t=e.trigger.textContent;e.trigger.textContent="Copied!",setTimeout(function(){e.trigger.textContent=t},3e3)}),f.on("error",function(e){var t=-1!==navigator.userAgent.indexOf("Mac OS")?"Cmd + C":"Ctrl + C";j.error("Clipboard access denied. Press "+t+" to copy.",8e3)}),c(k);var m=a("<form>",{"class":"yes-manual-input-form"}),h=a("<textarea>",{placeholder:"john@example.com, jane@example.com",rows:3,"class":"yes-manual-input-field"}),y=a("<button>",{text:p.manualInputSendBtn||"Add Emails","class":"yes-default-btn yes-manual-input-submit"}),_=-1!==v.settings.oauthServices.indexOf("outlook"),C=-1!==v.settings.oauthServices.indexOf("google"),O=-1!==v.settings.oauthServices.indexOf("yahoo"),D=0+Number(C)+Number(O)+2*Number(_),R=a("<div>",{"class":"yes-contact-import-section"}),M="";if(m.append(h,y),n.contactImporting&&x.append(R),n.emailSending&&x.append(m),E.init(),y.on("click",function(e){e.preventDefault();var t=d(h);l(t),h.val("")}),v.settings.oauthServices.length<=1&&(M=(v.widgetCopy.contactImportBtnCta||"Find friends")+" with "),C){var P=e({id:"google",name:"Gmail"});R.append(P),P.on("click",function(e){e.preventDefault(),U.authPopup().done(function(){E.openModal(),E.loading(),U.getContacts().done(function(e){s(e).done(function(e,t){E.isOpen||E.openModal(),E.loadContacts(e,t)}).fail(function(e){E.loadContacts(e,!0)})})}).fail(function(e){E.closeModal(),E.stopLoading(),j.error(e.error),t.error(e.error)})})}if(_){var N=e({id:"outlook",name:"Outlook"}),B=e({id:"hotmail",name:"Hotmail"});R.append(N,B),N.add(B).on("click",function(e){T.authPopup().done(function(e,t){E.isOpen||E.openModal(),E.loadContacts(e,t)}).fail(function(e){E.isOpen&&E.closeModal(),j.error(a(this).prop("title")+" Authorization Failed.")})})}if(O){var G=e({id:"yahoo",name:"Yahoo"});R.append(G),G.on("click",function(e){L.authPopup().done(function(e,t){E.isOpen||E.openModal(),E.loadContacts(e,t)}).fail(function(e){E.isOpen&&E.closeModal(),j.error("Yahoo Authorization Failed.")})})}}function i(){h=t.getApp();var e=a.Deferred(),n="/apps/"+h+"/js/get-options";return t.hitAPI(n,"GET").done(function(t){v=t,e.resolve(t)}).fail(function(n){t.error(n.error+". Please see the YesGraph SuperWidget Dashboard.",!0),e.reject(data)}),e.promise()}function s(e){var n,o=a.Deferred();return t.rankContacts(e).done(function(e){n=Boolean(e.meta.exception_matching_email_domain),o.resolve(e.data,n)}).fail(function(n){t.error("Contact ranking failed",!1),o.reject(e.entries)}),o.promise()}function c(n){if(0===v.shareButtons.length)return!1;for(var i,r,s,c,d,l=a("<div>"),p=t.getInviteLink(),u=[{ID:"facebook",name:"Facebook",baseURL:"https://www.facebook.com/share.php",params:{u:encodeURI(p),title:v.integrations.twitter.tweetMsg},colors:["#3B5998","#324b81"]},{ID:"twitter",name:"Twitter",baseURL:"https://twitter.com/intent/tweet",params:{text:v.integrations.twitter.tweetMsg+" "+p},colors:["#55ACEE","#2E99EA"]},{ID:"linkedin",name:"LinkedIn",baseURL:"https://www.linkedin.com/shareArticle",params:{mini:!0,url:p,title:v.appDisplayName,summary:v.integrations.twitter.tweetMsg},colors:["#0077B5","#006399"]},{ID:"pinterest",name:"Pinterest",baseURL:"https://www.pinterest.com/pin/create/button",params:{url:p},colors:["#BD081C","#AB071A"]}],f=0;f<u.length;f++)if(i=u[f],-1!==v.shareButtons.indexOf(i.ID))if(c=a("<span>",{"class":"yes-share-btn-icon"}),d=a("<span>",{text:i.name,"class":"yes-share-btn-text"}),c.css({"background-image":"url('"+o+"//cdn.yesgraph.com/"+i.ID+".png')"}),s=a("<span>",{"class":"yes-share-btn yes-share-btn-"+i.ID,"data-name":i.name,"data-url":i.baseURL+"?"+a.param(i.params),"data-color":i.colors[0],"data-hover-color":i.colors[1]}),s.css({"background-color":i.colors[0]}),s.hover(function(){var e=a(this);e.css("background-color",e.data("hover-color"))},function(){var e=a(this);e.css("background-color",e.data("color"))}),s.append(c,d),"pinterest"===i.ID){var m=a("<a>",{href:i.baseURL+"?"+a.param(i.params),"data-pin-do":"buttonBookmark","data-pin-custom":!0}).append(s);s.on("click",function(){a("img").not("[data-pin-description]").each(function(){this.dataset.pinDescription=v.integrations.twitter.tweetMsg+" "+p}),m[0].click()}),e("pinUtils",o+"//assets.pinterest.com/js/pinit.js",function(){l.append(m.append(s))})}else s.on("click",function(e){r=a(this),open(r.data("url"),"Share on "+r.data("name"),"width=550, height=550")}),l.append(s);n.append(l)}return{init:function(){i().done(n)}}}(),L=function(){function e(){function e(){var e;e="localhost"===window.location.hostname||v.integrations.yahoo.usingDefaultCredentials?window.location.origin:v.integrations.yahoo.redirectUrl;var t="https://api.login.yahoo.com/oauth2/request_auth?",n={response_type:"token",client_id:v.integrations.yahoo.clientId,redirect_uri:v.integrations.yahoo.redirectUrl,state:window.location.href},t=t+a.param(n);return[t,e]}var n=a.Deferred(),o=e(),i=o[0],r=o[1],s=open(i,"Yahoo Authorization","width=900, height=700"),c=0,d=setInterval(function(){try{if(-1!==s.document.URL.indexOf(r)){var e=s.document.URL,o=p(e,"error"),i=p(e,"error_description"),l=p(e,"access_token");if(clearInterval(d),s.close(),l){E.loading();var u={access_token:l};o&&(u.error=o,u.error_description=i),t.hitAPI("/oauth","GET",{service:"yahoo",token_data:JSON.stringify(u)}).done(function(e){if(e.error)n.reject(e);else{a(document).trigger(t.events.IMPORTED_CONTACTS,[{name:void 0,email:void 0,type:"yahoo"},e.data.raw_contacts]);var o=Boolean(e.meta.exception_matching_email_domain);n.resolve(e.data.ranked_contacts,o)}}).fail(function(e){n.reject(e)})}else{n.reject({error:OUTLOOK_FAILED_MSG});var f=o+" - "+(i||"").replace(/\+/g," ");t.error(f)}}}catch(m){var h=["Cannot read property 'URL' of undefined","undefined is not an object (evaluating 'win.document.URL')",'Permission denied to access property "document"'],g=-1!==h.indexOf(m.message)||18===m.code;if(c>=1e3||!g){var f=g?m.message:OUTLOOK_FAILED_MSG;t.error(f,!1),n.reject({error:f}),s.close(),clearInterval(d)}c++}},100);return n.promise()}return{authPopup:e}}(),T=function(){function e(){function e(){var e;e="localhost"===window.location.hostname||v.integrations.outlook.usingDefaultCredentials?window.location.origin:v.integrations.outlook.redirectUrl;var t="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?",o={response_type:"token",client_id:v.integrations.outlook.clientId,state:window.location.href,redirect_uri:v.integrations.outlook.redirectUrl},r=i([n]),t=t+a.param(o)+"&scope="+r;return[t,e]}function i(e){for(var t=[],n=0;n<e.length;n++)t.push(encodeURIComponent(e[n]));return t.join("+")}var r=a.Deferred(),s=e(),c=s[0],d=s[1],l=open(c,"Outlook Authorization","width=900, height=700"),u=0,f=setInterval(function(){try{if(-1!==l.document.URL.indexOf(d)){var e=l.document.URL,n=p(e,"error"),i=p(e,"error_description"),s=p(e,"access_token");if(clearInterval(f),l.close(),s){E.loading();var c={access_token:s};n&&(c.error=n,c.error_description=i),t.hitAPI("/oauth","GET",{service:"outlook",token_data:JSON.stringify(c)}).done(function(e){if(e.error)r.reject(e);else{a(document).trigger(t.events.IMPORTED_CONTACTS,[{name:void 0,email:void 0,type:"outlook"},e.data.raw_contacts]);var n=Boolean(e.meta.exception_matching_email_domain);r.resolve(e.data.ranked_contacts,n)}}).fail(function(e){r.reject(e)})}else{r.reject({error:o});var m=n+" - "+(i||"").replace(/\+/g," ");t.error(m)}}}catch(h){var g=["Cannot read property 'URL' of undefined","undefined is not an object (evaluating 'win.document.URL')",'Permission denied to access property "document"'],v=-1!==g.indexOf(h.message)||18===h.code;if(u>=1e3||!v){var m=v?h.message:o;t.error(m,!1),r.reject({error:m}),l.close(),clearInterval(f)}u++}},100);return r.promise()}var n="https://outlook.office.com/contacts.read",o="Outlook Authorization Failed";return{authPopup:e}}(),U=function(){function e(){var e=a.Deferred(),o="https://www.google.com/m8/feeds/contacts/default/full?max-results=1000000",i={access_token:GMAIL_ACCESS_TOKEN,alt:"json",orderby:"lastmodified"};return a.ajax({url:o,data:i,dataType:"jsonp",success:function(o){contacts=n(o.feed),a(document).trigger(t.events.IMPORTED_CONTACTS,[contacts.source,o]),e.resolve(contacts)},error:function(t){e.reject()}}),e.promise()}function n(e){var t,n,o=[];for(i in e.entry){if(t=e.entry[i],n={},t.title.$t&&(n.name=t.title.$t),t.gd$email){n.emails=[];for(i in t.gd$email)n.emails.push(t.gd$email[i].address)}o.push(n)}var a={source:{type:"gmail",name:e.author[0].name.$t,email:e.author[0].email.$t},entries:o};return a}function o(){function e(){var e;e=-1!==["localhost","lvh.me"].indexOf(window.location.hostname)||v.integrations.google.usingDefaultCredentials?window.location.origin:v.integrations.google.redirectUrl;var t={response_type:"token",client_id:v.integrations.google.clientId,state:window.location.href,redirect_uri:v.integrations.google.redirectUrl},o=n(["https://www.google.com/m8/feeds/","https://www.googleapis.com/auth/userinfo.email"]),i="https://accounts.google.com/o/oauth2/auth?"+a.param(t)+"&scope="+o;return[i,e]}function n(e){for(var t=[],n=0;n<e.length;n++)t.push(encodeURIComponent(e[n]));return t.join("+")}var o=a.Deferred(),i=e()[0],r=e()[1],s=open(i,"Google Authorization","width=550, height=550"),c=0,d=setInterval(function(){try{if(-1!==s.document.URL.indexOf(r)){var e=s.document.URL,n=p(e,"error"),i=p(e,"access_token");i?(GMAIL_ACCESS_TOKEN=i,o.resolve({token:GMAIL_ACCESS_TOKEN,type:p(e,"token_type"),expires_in:p(e,"expires_in")}),clearInterval(d),s.close()):"access_denied"===n&&(o.reject({error:"Access Denied"}),clearInterval(d),s.close())}}catch(a){var l=["Cannot read property 'URL' of undefined","undefined is not an object (evaluating 'win.document.URL')",'Permission denied to access property "document"'],u=-1!==l.indexOf(a.message)||18===a.code;if(c>=1e3||!u){var f=a.message;u&&(f="Gmail authorization failed."),t.error(f,!1),o.reject({error:f}),s.close(),clearInterval(d)}c++}},100);return o.promise()}return{authPopup:o,getContacts:e}}();c().then(D.init)}))})})}var t="v0.0.2",n="v0.0.3",o=setInterval(function(){"complete"!==document.readyState&&"interactive"!==document.readyState||(e(),clearInterval(o))},100)}();